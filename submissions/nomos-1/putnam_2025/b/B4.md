# B4

## Problem

For $n \ge 2$, let $A = [a_{i,j}]_{i,j=1}^{n}$ be an $n \times n$ matrix of nonnegative integers such that

1. $a_{i,j} = 0$ when $i + j \le n$;
2. $a_{i+1,j} \in \{a_{i,j},\, a_{i,j} + 1\}$ when $1 \le i \le n-1$ and $1 \le j \le n$; and
3. $a_{i,j+1} \in \{a_{i,j},\, a_{i,j} + 1\}$ when $1 \le i \le n$ and $1 \le j \le n-1$.

Let $S$ be the sum of the entries of $A$, and let $N$ be the number of nonzero entries of $A$. Prove that
\[
S \le \frac{(n+2)N}{3}.
\]

## Submission

We prove the inequality by considering the level sets of the matrix entries. For each positive integer $k$ define
\[
L_k = \{(i,j): a_{i,j} \ge k\}.
\]
Since $a_{i,j}$ are nonnegative integers, the sets $L_k$ are nonempty for $1\le k\le \max_{i,j}a_{i,j}$ and form a descending chain $L_1\supseteq L_2\supseteq\cdots$.  
Condition 2 and 3 imply that if $a_{i,j}\ge k+1$ then $a_{i-1,j}\ge k$ and $a_{i,j-1\ge k$; hence
\[
L_{k+1}\subseteq I(L_k):=\{(i,j): i\ge 2,\;j\ge 2,\; (i-1,j)\in L_k,\;(i,j-1)\in L_k\}.
\tag{1}
\]
Moreover, if $(i,j)\in L_1$ then $i+j>n$ (by condition 1) and $a_{i+1,j}\ge a_{i,j}\ge 1$, $a_{i,j+1}\ge a_{i,j}\ge 1$, so $L_1$ is an **upper set**:
\[
(i,j)\in L_1 \;\Longrightarrow\; (i+1,j),(i,j+1)\in L_1.
\]

Let $S=\sum_{i,j}a_{i,j}=\sum_{k\ge 1}|L_k|$ and $N=|L_1|$. We shall show
\[
S \le \frac{n+2}{3}\,N.
\]

The proof is by induction on $n$. For $n=2$ one checks all possibilities directly.

Assume $n\ge 3$ and the statement holds for all smaller sizes.  
First we need a combinatorial lemma.

---
**Lemma.**  
Let $L$ be an upper set contained in $P_n=\{(i,j):1\le i,j\le n,\;i+j>n\}$. For $i=1,\dots,n$ set $\ell_i = |\{j:(i,j)\in L\|$ (with $\ell_i=0$ if the row is empty).  
Then  

* $\ell_1\le 1$ (because $(1,1)\notin P_n$);  
* $\ell_i\le i$ (otherwise $(i,n-i)\in L$ would violate $i+(n-i)=n$);  
* $\ell_1\le \ell_2\le\cdots\le \ell_n$ (upper set property).  

Define $D = \#\{i=2,\dots,n:\ell_i=\ell_{i-1\}$. Then
\[
|I(L)| = \sum_{i=1}^{n-1}\ell_i - D.
\]
Moreover,
\[
|I(L)| \le \frac{n-1}{n+1}\,|L|.
\tag{2}
\]

*Proof.* The expression for $|I(L)|$ follows from the description of $I(L)$: a cell $(i,j)$ with $i\ge2$, $j\ge2$ belongs to $I(L)$ iff $j\ge2$ and both $(i-1,j)$ and $(i,j-1)$ are in $L$.  
For a fixed row $i\ge2$ the first column of $I(L)$ in that row is $\max(\ell_{i-1,\ell_i+1)$, which gives $\ell_i'= \ell_{i-1$ if $\ell_{i-1}>\ell_i$ and $\ell_i'= \ell_i-1$ if $\ell_{i-1}=\ell_i$ (and $0$ otherwise). Hence $|I(L)|=\sum_{i=1}^{n-1}\ell_i - D$.

Inequality (2) is equivalent to
\[
2\sum_{i=1}^{n-1}\ell_i \le (n-1)\ell_n + (n+1)D.
\tag{3}
\]
We prove (3) by induction on $n$. For $n=2$ it is straightforward.  
Assume $n\ge3$.  
If $\ell_n=\ell_{n-1$ then $D = D'+1$ where $D'=\#\{i=2,\dots,n-1:\ell_i=\ell_{i-1\}$. Using the induction hypothesis for the first $n-1$ rows,
\[
2\sum_{i=1}^{n-2}\ell_i \le (n-2)\ell_{n-1 + n D'.
\]
Hence
\[
2\sum_{i=1}^{n-1}\ell_i = 2\sum_{i=1}^{n-2}\ell_i + 2\ell_{n-1} \le (n-2)\ell_{n-1 + n D' + 2\ell_{n-1} = n\ell_{n-1 + n D'.
\]
The right‑hand side of (3) becomes $(n-1)\ell_n + (n+1)D = (n-1)\ell_{n-1 + (n+1)(D'+1) = (n-1)\ell_{n-1 + (n+1)D' + (n+1)$.  
Thus it suffices to show $n\ell_{n-1 + n D' \le (n-1)\ell_{n-1 + (n+1)D' + (n+1)$, i.e. $\ell_{n-1 \le D' + (n+1)$, which is true because $\ell_{n-1\le n-1$.  

If $\ell_n>\ell_{n-1$ then $D = D'$. Again by induction,
\[
2\sum_{i=1}^{n-2}\ell_i \le (n-2)\ell_{n-1 + n D'.
\]
Therefore
\[
2\sum_{i=1}^{n-1}\ell_i \le (n-2)\ell_{n-1 + n D' + 2\ell_{n-1 = n\ell_{n-1 + n D'.
\]
Now $(n-1)\ell_n + (n+1)D' \ge (n-1)(\ell_{n-1+1) + (n+1)D' = (n-1)\ell_{n-1 + (n-1) + (n+1)D'$, so it is enough to have
$n\ell_{n-1 + n D' \le (n-1)\ell_{n-1 + (n-1) + (n+1)D'$, i.e. $\ell_{n-1 \le n-1 + D'$, again true.  
This completes the proof of the lemma. ∎

---
Now apply the lemma to $L_1$ (which is an upper set in $P_n$). We obtain
\[
|L_2| \le \frac{n-1}{n+1}\,|L_1|.
\tag{4}
\]

Define shifted sets $L'_k = \{(i-1,j-1): (i,j)\in L_{k+1}\}$ for $k\ge 1$. Because $L_{k+1}\subseteq I(L_k)\subseteq P_n$, we have $i,j\ge2$ and $i+j\ge n+2$, so $(i-1)+(j-1)\ge n$, hence $L'_1\subseteq P_{n-1$. Moreover,
\[
L'_{k+1} = I'(L'_k),
\]
where $I'$ is the interior operator for size $n-1$. Thus the chain $L'_1\supseteq L'_2\supseteq\cdots$ satisfies the same hypothesis for $n-1$. By the induction hypothesis,
\[
\sum_{k=2}^{\infty}|L_k| = \sum_{k=1}^{\infty}|L'_k| \le \frac{(n-1)+2}{3}\,|L'_1| = \frac{n+1}{3}\,|L_2|.
\]

Finally,
\[
S = |L_1| + \sum_{k=2}^{\infty}|L_k| \le |L_1| + \frac{n+1}{3}\,|L_2| \le |L_1| + \frac{n+1}{3}\cdot\frac{n-1}{n+1}\,|L_1| = \frac{n+2}{3}\,|L_1| = \frac{n+2}{3}\,N.
\]

This completes the induction and the proof. $\square$
