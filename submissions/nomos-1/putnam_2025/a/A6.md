# A6

## Problem

Let $b_0 = 0$ and, for $n \ge 0$, define
\[
b_{n+1} = 2b_n^2 + b_n + 1.
\]

For each $k \ge 1$, show that
\[
b_{2^{k+1}} - 2b_{2^k}
\]
is divisible by $2^{2k+2}$ but not by $2^{2k+3}$.

## Submission

We define the function \(f(x)=2x^{2}+x+1\).  For \(n\ge 0\) let \(f^{n}\) denote the \(n\)-fold iterate, so that  
\[
b_{0}=0,\quad b_{n+1}=f(b_{n}=f^{n+1}(0).
\]

---
### 1.  Notation and basic properties

For \(n\ge 1\) set  
\[
D_{n}=f^{\prime}(0)^{\,n}=\prod_{i=0}^{n-1}f^{\prime}(f^{i}(0))=\prod_{i=0}^{n-1}(4b_{i}+1),
\]
and \(D_{0}=1\).  Every iterate \(f^{n}\) is a polynomial with integer coefficients; we can write it as  
\[
f^{n}(x)=b_{n}+D_{n}x+x^{2}H_{n}(x) \tag{1}
\]
for some integer polynomial \(H_{n}\).  The constant term is \(b_{n}=f^{n}(0)\) and the linear coefficient is \(D_{n}=f^{n\prime}(0)\).

**Lemma 1.**  For every \(n\ge 1\) the coefficient of \(x^{2}\) in \(f^{n}(x)\) is even.  
*Proof.*  \(f^{1}(x)=2x^{2}+x+1\), coefficient \(2\) even.  Assume the claim for \(f^{n}\) and write  
\(f^{n}(x)=A+B x+C x^{2}+\cdots\) with \(C\) even.  Then  
\[
f^{n+1}(x)=2\bigl(f^{n}(x)\bigr)^{2}+f^{n}(x)+1,
\]  
and the coefficient of \(x^{2}\) in the right‑hand side is \(2(B^{2+2AC)+C\), which is even because \(C\) is even.  ∎

**Lemma 2.**  For every \(n\ge 1\) we have \(v_{2}(b_{n})=v_{2}(n)+1\) (with the convention \(v_{2}(0)=\infty\)).  
In particular, if \(n=2^{k}\) then \(b_{2^{k}=2^{k+1}\cdot a_{k}\) with \(a_{k}\) odd.  
*Proof.*  A simple induction using the recurrence; we only need the case of powers of two later.  ∎

---
### 2.  Induction on \(k\)

We prove by induction on \(k\ge 1\) the following two statements:

* **(A)**  \(b_{2^{k}=2^{k+1}a_{k}\) with \(a_{k}\) odd.  
* **(B)**  \(D_{2^{k}=1+2^{k+1}u_{k}\) with \(u_{k}\) odd.

*Base \(k=1\).*  \(b_{2}=4=2^{2}\cdot1\), \(a_{1}=1\) odd.  \(D_{2}=(4\cdot0+1)(4\cdot1+1)=5=1+4\cdot1\), \(u_{1}=1\) odd.  

*Inductive step.*  Assume (A) and (B) hold for some \(k\ge 1\).  We first analyse the block of indices from \(2^{k}\) to \(2^{k+1}-1\).

---
#### 2.1  Behaviour of \(4b_{i}+1\) in the block

**Claim.**  For every \(j\) with \(0\le j<2^{k}\) we have  
\[
4b_{2^{k}+j}+1\equiv
\begin{cases}
1 \pmod{2^{k+2} & \text{if }j\text{ is even},\\[2pt]
5 \pmod{2^{k+2} & \text{if }j\text{ is odd}.
\end{cases}
\tag{2}
\]
*Proof.*  For \(j=0\) we have \(b_{2^{k}\) divisible by \(2^{k+1\) (by (A)), hence \(4b_{2^{k}+1\equiv1\pmod{2^{k+3}\) and therefore \(\pmod{2^{k+2}\).  
Assume (2) holds for some \(j\) and consider \(j+1\).

*If \(j\) is even*, then \(4b\equiv0\pmod{2^{k+2}\); write \(b=2^{k}t\).  Then  
\[
4b_{j+1}+1=8b^{2}+4b+5.
\]  
Because \(b\) is a multiple of \(2^{k}\), the term \(8b^{2}\) is a multiple of \(2^{2k+3}\ge 2^{k+2\) (for \(k=1\) it is a multiple of \(8\)), and \(4b\) is a multiple of \(2^{k+2}\).  Hence \(4b_{j+1}+1\equiv5\pmod{2^{k+2}\).

*If \(j\) is odd*, then \(4b\equiv4\pmod{2^{k+2}\); write \(b=1+2^{k}s\).  Then  
\[
8b^{2}=8\bigl(1+2^{k+1}s+2^{2k}s^{2}\bigr)=8+2^{k+3}s+2^{2k+3}s^{2}.
\]  
For \(k=1\) the term \(8b^{2}\) is a multiple of \(8\); for \(k\ge2\) it is congruent to \(8\) modulo \(2^{k+2}\).  Moreover \(4b=4+2^{k+2}s\equiv4\pmod{2^{k+2}\).  Consequently  
\[
4b_{j+1}+1\equiv8+4+5=17\equiv1\pmod{2^{k+2}.
\]  
Thus (2) holds for \(j+1\).  ∎

---
#### 2.2  The product over the block

Let  
\[
Q=\prod_{i=2^{k}^{2^{k+1}-1}\bigl(4b_{i}+1\bigr).
\]  
By (2) the even indices contribute a factor \(1\) modulo \(2^{k+2\) and the odd indices a factor \(5\).  There are exactly \(2^{k-1\) odd indices, so  
\[
Q\equiv5^{2^{k-1}\pmod{2^{k+2}.
\]  
Since \(5=1+4\) and  
\[
(1+4)^{2^{k-1}=1+4\cdot2^{k-1+\text{terms divisible by }2^{k+2},
\]  
we obtain \(Q\equiv1+2^{k+1}\pmod{2^{k+2}\).  Because \(Q\) is odd we can write \(Q=1+2^{k+1}v\) with \(v\) odd.

---
#### 2.3  The derivative for the next power

Using (B) for \(2^{k}\) and the product \(Q\) we get  
\[
D_{2^{k+1}=D_{2^{k}Q=(1+2^{k+1}u)(1+2^{k+1}v)=1+2^{k+1}(u+v)+2^{2k+2}uv.
\]  
Both \(u,v\) are odd, hence \(u+v\) is even; set \(u+v=2w\).  Then  
\[
D_{2^{k+1}=1+2^{k+2}w+2^{2k+2}uv=1+2^{k+2}\bigl(w+2^{k}uv\bigr).
\]  
Now \(w=(u+v)/2\) is odd, and \(2^{k}uv\) is even, therefore \(w+2^{k}uv\) is odd.  Thus  
\[
D_{2^{k+1}=1+2^{k+2}\cdot\text{(odd)},
\]  
which is statement (B) for \(k+1\).

---
#### 2.4  The value \(b_{2^{k+1}\)

From (1) with \(n=2^{k}\) we have  
\[
f^{2^{k}(x)=b_{2^{k}+D_{2^{k}x+x^{2}H_{2^{k}(x).
\]  
Evaluating at \(x=b_{2^{k}\) gives  
\[
b_{2^{k+1}=f^{2^{k}(b_{2^{k})=b_{2^{k}+D_{2^{k}b_{2^{k}+b_{2^{k}^{2}H_{2^{k}(b_{2^{k})}.
\]  
Write \(b_{2^{k}=2^{k+1}a\) (with \(a\) odd) and \(D_{2^{k}=1+2^{k+1}u\) (\(u\) odd).  Then  
\[
\begin{aligned}
b_{2^{k+1}&=2^{k+1}a\bigl(1+1+2^{k+1}u\bigr)+2^{2k+2}a^{2}H_{2^{k}(b_{2^{k})\\
&=2^{k+2}a+2^{2k+2}a\bigl(u+aH_{2^{k}(b_{2^{k})\bigr)\\
&=2^{k+2}a\Bigl(1+2^{k}\bigl(u+aH_{2^{k}(b_{2^{k})\bigr).
\end{aligned}
\]  
By Lemma 1 the constant term of \(H_{2^{k}\) (i.e. the coefficient of \(x^{2}\) in \(f^{2^{k}\)) is even; since \(b_{2^{k}\) is even, \(H_{2^{k}(b_{2^{k})\) is even.  Hence \(2^{k}\bigl(u+aH_{2^{k}(b_{2^{k})\) is even, and the factor in parentheses is odd.  Consequently  
\[
b_{2^{k+1}=2^{k+2}\cdot\text{(odd)},
\]  
which is statement (A) for \(k+1\).

The induction is complete.

---
### 3.  The required divisibility

For \(k\ge 1\) we now have  
\[
b_{2^{k}=2^{k+1}a,\quad b_{2^{k+1}=2^{k+2}a\bigl(1+2^{k}*\text{even}\bigr),\quad D_{2^{k}=1+2^{k+1}u,
\]  
with \(a,u\) odd.  Therefore  
\[
\begin{aligned}
b_{2^{k+1}-2b_{2^{k}&=\bigl(b_{2^{k}+D_{2^{k}b_{2^{k}+b_{2^{k}^{2}H_{2^{k}(b_{2^{k})\bigr)-2b_{2^{k}}\\
&=b_{2^{k}(D_{2^{k}-1)+b_{2^{k}^{2}H_{2^{k}(b_{2^{k})\\
&=2^{k+1}a\cdot2^{k+1}u+2^{2k+2}a^{2}H_{2^{k}(b_{2^{k})\\
&=2^{2k+2}\bigl(au+2^{k}aH_{2^{k}(b_{2^{k})\bigr).
\end{aligned}
\]  
Because \(au\) is odd and \(2^{k}aH_{2^{k}(b_{2^{k})\) is even, the bracket is odd.  Moreover \(H_{2^{k}(b_{2^{k})\) is even, so \(b_{2^{k}^{2}H_{2^{k}(b_{2^{k})\) is actually divisible by \(2^{2k+3}\); this does not affect the valuation.  

Thus \(v_{2}\bigl(b_{2^{k+1}-2b_{2^{k}\bigr)=2k+2\), i.e. the difference is divisible by \(2^{2k+2}\) but not by \(2^{2k+3}\). ∎
